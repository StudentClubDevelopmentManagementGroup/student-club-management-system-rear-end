<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="team.project.module.club.management.internal.mapper.TblClubMapper">
    <resultMap id="tbl_club_DO" type="team.project.module.club.management.internal.model.entity.TblClubDO">
        <!-- 数据库字段 -->                  <!-- java 类属性 -->
        <result column="id"                 property="id" />
        <result column="is_deleted"         property="isDeleted" />
        <result column="create_time"        property="createTime" />
        <result column="update_time"        property="updateTime" />
        <result column="department_id"      property="departmentId" />
        <result column="name"               property="name" />
        <result column="state"              property="state" />
    </resultMap>

    <resultMap id="clubmasVO" type="team.project.module.club.management.internal.model.datatransfer.ClubMasDTO">
        <!-- 数据库字段 -->                  <!-- java 类属性 -->
        <result column="is_deleted"         property="deleted" />
        <result column="department_id"      property="departmentId" />
        <result column="club_id"      property="clubId" />
        <result column="department_name"    property="departmentName" />
        <result column="name"               property="name" />
        <result column="state"              property="state" />
    </resultMap>


    <select id="findByNameAndDepartmentId"
            resultMap="tbl_club_DO">
        select * from tbl_club
        where name = #{name} and department_id = #{departmentId}
    </select>
    <select id="selectByNameAndDepartmentId"
            resultMap="tbl_club_DO">
        select * from tbl_club
        where name = #{name} and department_id = #{departmentId}
    </select>

    <select id="selectByName"
            resultMap="tbl_club_DO">
        select * from tbl_club
        where name = #{name}
    </select>

    <select id="selectByDepartmentId"
            resultMap="tbl_club_DO">
        select * from tbl_club
        where department_id = #{departmentId}
    </select>

    <update id="createClub">
        insert into tbl_club (name, state, department_id)
        values (#{name}, 0, #{departmentId})
    </update>

    <update id="deleteClub">
        update tbl_club set is_deleted = 1 where name = #{name} and department_id = #{departmentId} and is_deleted = 0
    </update>

    <update id="reuseClub">
        update tbl_club set  state = 0 where name = #{name} and department_id = #{departmentId} and state = 1
    </update>

    <update id="deactivateClub">
        update tbl_club set  state = 1 where name = #{name} and department_id = #{departmentId} and state = 0
    </update>

    <update id="recoverClub">
        update tbl_club set is_deleted = 0 where name = #{name} and department_id = #{departmentId} and is_deleted = 1
    </update>
    <select id="findAll"
            resultMap="clubmasVO">
        SELECT * from view_club_manager
    </select>
    <select id="findAllByDepartmentId"
            resultMap="clubmasVO">
        SELECT * from view_club_manager
        WHERE department_id = #{departmentId}
    </select>
    <select id="findAllByName"
            resultMap="clubmasVO">
        SELECT * from view_club_manager
        WHERE name = #{name}
    </select>
    <select id="findAllByDepartmentIdAndName"
            resultMap="clubmasVO">
        SELECT * from view_club_manager
        WHERE department_id = #{departmentId} and name = #{name}
    </select>
    <!--     TODO xml文件加上逻辑删除-->
</mapper>
